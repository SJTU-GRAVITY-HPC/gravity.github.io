<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Gravity Documentation</title>
  <meta name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta name="keywords" content="sjtu,doa,astronomy,hpc,cluster,jupyter,documentation">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <script>
    // Function to load a CSS file from multiple URLs and select the fastest one
    function loadFastestCSS(cssName, urls, timeout = 3000) {
      let bestUrl = null;
      let bestTime = Infinity;

      // Function to create a <link> element and measure its load time
      function loadCSS(url) {
        return new Promise((resolve, reject) => {
          const start = Date.now();
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          // link.type = 'text/css';
          link.href = url;
          link.onload = () => {
            const loadTime = Date.now() - start;
            if (loadTime < bestTime) {
              bestTime = loadTime;
              bestUrl = url;
            }
            resolve();
          };
          link.onerror = () => reject(new Error('Failed to load CSS: ' + url));
          document.head.appendChild(link);
        });
      }

      // Function to create a timeout promise
      function createTimeoutPromise(ms) {
        return new Promise((_, reject) => {
          setTimeout(() => reject(new Error('Load CSS timeout')), ms);
        });
      }

      // Function to handle all CSS loading with timeout
      function loadCSSFiles() {
        const promises = urls.map(url => Promise.race([
          loadCSS(url),
          createTimeoutPromise(timeout)
        ]));

        return Promise.allSettled(promises).then(() => {
          if (bestUrl) {
            console.log(`Fastest ${cssName} CSS loaded from:`, bestUrl);
            // Optionally, you could remove other CSS files if needed
            // Example: removing other <link> tags for the same CSS name
            const links = document.querySelectorAll(`link[href^="${cssName}"]`);
            links.forEach(link => {
              if (link.href !== bestUrl) {
                document.head.removeChild(link);
              }
            });
          } else {
            console.log(`No ${cssName} CSS loaded within the timeout.`);
          }
        }).catch(error => {
          console.error('Error loading CSS:', error);
        });
      }

      // Start loading the CSS files
      loadCSSFiles();
    }

    cssUrls = [
      "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/style.min.css",
      "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/style.min.css",
      "//cdn.jsdelivr.net/npm/docsify-darklight-theme@latest/dist/style.min.css",
    ];
    loadFastestCSS('docsify-darklight-theme', cssUrls, 1000); // 1 seconds timeout

    cssUrls = [
      "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/logo_DOA_mini.png",
      "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/logo_DOA_mini.png",
    ];
    loadFastestCSS('logo_DOA_mini', cssUrls, 1000); // 1 seconds timeout

  </script>

  <style>
    nav.app-nav li ul {
      min-width: 100px;
    }

    #carbonads {
      box-shadow: none !important;
      width: auto !important;
    }
  </style>

</head>

<body>
  <div id="app">Loading (/≧▽≦)/... ...</div>
  <script>
    window.$docsify = {
      alias: {
        '/.*/_navbar.md': '/_navbar.md',
        '/.*/_sidebar.md': '/_sidebar.md',
      },
      auto2top: true,
      // basePath: '/docs/',
      // relativePath: true,
      coverpage: true,
      executeScript: true,
      loadSidebar: true,
      loadNavbar: true,
      mergeNavbar: true,
      maxLevel: 6,
      subMaxLevel: 6,
      notFoundPage: true,
      name: 'Gravity Documentation',
      repo: 'https://github.com/gravity-doc/gravity-doc.github.io/',
      logo: 'https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/logo_DOA_mini.png',
      search: 'auto',
      search: {
        maxAge: 10000,
        paths: 'auto',
        placeholder: 'Search / 搜索关键词',
        noData: 'No results / 无结果 ╥﹏╥...',
        depth: 6,
        hideOtherSidebarContent: false
      },
      // busuanzi: true,
      // count:{
      //     countable:true,
      //     fontsize:'0.9em',
      //     color:'rgb(90,90,90)',
      //     language:'english'
      // },
      copyCode: {
        buttonText: 'Copy to clipboard',
        errorText: 'Error',
        successText: 'Copied',
      },
      // 'flexible-alerts': {
      //   style: 'flat'
      // },
    }

  </script>

  <script>
    // Function to load a script from multiple URLs and select the fastest one
    function loadFastestScript(scriptName, urls, timeout = 1000) {
      let bestUrl = null;
      let bestTime = Infinity;

      // Function to create a <script> element and measure its load time
      function loadScript(url) {
        return new Promise((resolve, reject) => {
          const start = Date.now();
          const script = document.createElement('script');
          script.src = url;
          script.onload = () => {
            const loadTime = Date.now() - start;
            if (loadTime < bestTime) {
              bestTime = loadTime;
              bestUrl = url;
            }
            resolve();
          };
          script.onerror = () => reject(new Error('Failed to load script: ' + url));
          document.head.appendChild(script);
        });
      }

      // Function to create a timeout promise
      function createTimeoutPromise(ms) {
        return new Promise((_, reject) => {
          setTimeout(() => reject(new Error('Load script timeout')), ms);
        });
      }

      // Function to handle script loading with timeout
      function loadScripts() {
        const promises = urls.map(url => Promise.race([
          loadScript(url),
          createTimeoutPromise(timeout)
        ]));

        return Promise.allSettled(promises).then(() => {
          if (bestUrl) {
            console.log(`Fastest ${scriptName} script loaded from:`, bestUrl);
            return bestUrl; // Return the best URL
          } else {
            console.log(`No ${scriptName} scripts loaded within the timeout.`);
            throw new Error(`No ${scriptName} scripts loaded.`);
          }
        }).catch(error => {
          console.error('Error loading scripts:', error);
          throw error; // Re-throw error to be handled in sequence chain
        });
      }

      // Start loading the scripts
      return loadScripts();
    }

    // Function to load scripts in sequence
    function loadScriptsInSequence() {
      docsifyJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify.min.js",
        "//cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js",
      ];
      alertsJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify-plugin-flexible-alerts",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify-plugin-flexible-alerts",
        "//cdn.jsdelivr.net/npm/docsify-plugin-flexible-alerts@1/dist/docsify-plugin-flexible-alerts.min.js",
      ];
      darkThemeJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/index.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/index.min.js",
        "//cdn.jsdelivr.net/npm/docsify-darklight-theme@latest/dist/index.min.js",
      ];
      searchJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/search.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/search.min.js",
        "//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js",
      ];
      copyCodeJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify-copy-code.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify-copy-code.min.js",
        // "//unpkg.com/docsify-copy-code@2",
        "//cdn.jsdelivr.net/npm/docsify-copy-code@3.0.0/dist/docsify-copy-code.min.js",
      ];
      zoomImageJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/zoom-image.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/zoom-image.min.js",
        "//cdn.jsdelivr.net/npm/docsify/lib/plugins/zoom-image.min.js",
      ];
      paginationJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify-pagination.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/docsify-pagination.min.js",
        "//cdn.jsdelivr.net/npm/docsify-pagination@2/dist/docsify-pagination.min.js",
      ];
      bashJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-bash.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-bash.min.js",
        "//cdn.jsdelivr.net/npm/prismjs@1/components/prism-bash.min.js",
      ];
      markdownJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-markdown.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-markdown.min.js",
        "//cdn.jsdelivr.net/npm/prismjs@1/components/prism-markdown.min.js",
      ];
      jsonJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-json.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-json.min.js",
        "//cdn.jsdelivr.net/npm/prismjs@1/components/prism-json.min.js",
      ];
      pythonJsUrls = [
        "https://gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-python.min.js",
        "https://jupyter.gravity.sjtu.edu.cn/file/api/public/dl/bjEJwMgn/JS_cache/prism-python.min.js",
        "//cdn.jsdelivr.net/npm/prismjs@1/components/prism-python.min.js",
      ];

      return Promise.all([
        loadFastestScript('darkTheme.js', darkThemeJsUrls),
        loadFastestScript('copyCode.js', copyCodeJsUrls),
        loadFastestScript('zoomImage.js', zoomImageJsUrls),
        loadFastestScript('pagination.js', paginationJsUrls),
        loadFastestScript('alerts.js', alertsJsUrls),
      ]).then(() => {
        return Promise.all([
          loadFastestScript('docsify.js', docsifyJsUrls),
          loadFastestScript('search.js', searchJsUrls),
        ]);
      }).then(() => {
        return Promise.all([
          loadFastestScript('bash.js', bashJsUrls),
          loadFastestScript('markdown.js', markdownJsUrls),
          loadFastestScript('json.js', jsonJsUrls),
          loadFastestScript('python.js', pythonJsUrls),
        ]);
      }).catch(error => {
        console.error('Error in script loading sequence:', error);
      });
    }

    // Execute the scripts in sequence
    document.addEventListener('DOMContentLoaded', () => {
      loadScriptsInSequence();
    });
  </script>
</body>

</html>